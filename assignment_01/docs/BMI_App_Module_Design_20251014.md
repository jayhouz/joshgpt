**System Name:** **"BMI & Holistic Health AI"**

**Core Goal:** To provide users with an accurate BMI calculation, an understanding of their BMI category, and personalized, general health tips and recommendations generated by an LLM, all within a clear, step-by-step interactive experience.

---

## I. Key Principles & Philosophy

1.  **User-Centric:** Simple, intuitive, step-by-step flow.
2.  **Accuracy:** Correct BMI calculation based on user input.
3.  **Transparency:** Clearly explain BMI, its limitations, and the AI's role.
4.  **Responsibility:** Emphasize that AI advice is general and not a substitute for professional medical consultation. Prominent disclaimers are a must.
5.  **Personalization (via LLM):** Leverage GPT's ability to provide context-aware, tailored suggestions based on BMI category and additional user input.
6.  **Safety:** Avoid making specific medical claims or diagnoses.

---

## II. System Architecture (High-Level)

*   **Frontend (User Interface):** Web Application (React, Vue, Angular) or Mobile App (Flutter, React Native) for input and display.
*   **Backend (API Server):** Handles input validation, unit conversions, BMI calculation, and communicates with the LLM API. (e.g., Python/Flask/Django, Node.js/Express, Go).
*   **LLM API:** OpenAI GPT-4 (or a fine-tuned version) or a similar capable model.

---

## III. Step-by-Step User Flow & Design Details

Here's the detailed interaction flow, from the user's perspective, with backend logic and LLM interaction points specified.

---

### **Step 1: Welcome & Essential Disclaimer**

*   **User sees:**
    *   **Title:** "Welcome to BMI & Holistic Health AI"
    *   **Greeting:** "Let's calculate your Body Mass Index and get some general health insights!"
    *   **Critical Disclaimer (Prominent & Unmissable):**
        > "⚠️ **Important Health Disclaimer:** This tool provides general health information and recommendations based on your input and an AI model. It is **NOT** a substitute for professional medical advice, diagnosis, or treatment from a qualified healthcare provider. Always consult with a doctor or registered dietitian before making any significant changes to your diet, exercise, or health regimen, especially if you have underlying health conditions. Your privacy is important to us; all inputs are used solely for generating your immediate results."
    *   **Call to Action:** "I understand and agree. Let's start!" (Button)
*   **Backend Logic:**
    *   No processing yet. Acknowledgment is just a UI state change.

---

### **Step 2: Collect Basic Demographic Information**

*   **Purpose:** To give the LLM more context for personalized, age/gender-appropriate advice.
*   **User sees:**
    *   **Prompt:** "To help us provide more relevant tips, please tell us:"
    *   **Input Field 1:** "Your Age (Years):" (Numerical input, e.g., 18-99, with validation)
    *   **Input Field 2:** "Your Biological Sex (at birth, for BMI context):" (Dropdown: Male, Female, Prefer not to say)
        *   *(Note: BMI calculation itself doesn't use sex, but health recommendations often differ based on it. Add a small 'i' icon explaining this.)*
    *   **Call to Action:** "Next" (Button)
*   **Backend Logic:**
    *   **Input Validation:**
        *   Age: Must be a positive integer, typically between 5 and 120.
        *   Sex: Must be one of the dropdown options.
    *   **Store:** Temporarily store `age` and `sex`.

---

### **Step 3: Collect Weight Input**

*   **User sees:**
    *   **Prompt:** "What is your current weight?"
    *   **Input Field:** [_________] (Numerical input)
    *   **Unit Selector:** Radio buttons or dropdown: `Kilograms (kg)` / `Pounds (lbs)` (Default to a common unit based on locale, e.g., lbs for US, kg for Europe).
    *   **Call to Action:** "Next" (Button)
*   **Backend Logic:**
    *   **Input Validation:**
        *   Weight: Must be a positive number. Range check (e.g., 20 kg - 300 kg or 44 lbs - 660 lbs).
    *   **Store:** Temporarily store `weight` and `weight_unit`.

---

### **Step 4: Collect Height Input**

*   **User sees:**
    *   **Prompt:** "What is your current height?"
    *   **Unit Selector:** Radio buttons or dropdown: `Centimeters (cm)` / `Meters (m)` / `Feet & Inches (ft/in)` (Default as above).
    *   **Input Fields (Dynamic based on unit selection):**
        *   If `cm`: [_________] cm (Numerical)
        *   If `m`: [_________] m (Numerical)
        *   If `ft/in`: [_________] ft [_________] in (Two numerical inputs)
    *   **Call to Action:** "Calculate My BMI" (Button)
*   **Backend Logic:**
    *   **Input Validation:**
        *   Height: Must be a positive number. Range check (e.g., 50 cm - 250 cm or 1 ft 8 in - 8 ft 2 in).
    *   **Store:** Temporarily store `height` and `height_unit`.

---

### **Step 5: Process Data & Calculate BMI**

*   **Backend Logic:**
    *   **Unit Conversion:**
        *   Convert `weight` to kilograms (kg):
            *   If `lbs`, `kg = lbs * 0.453592`
        *   Convert `height` to meters (m):
            *   If `cm`, `m = cm / 100`
            *   If `ft/in`, `total_inches = (feet * 12) + inches`; `m = total_inches * 0.0254`
    *   **BMI Calculation:**
        *   `BMI = weight_in_kg / (height_in_m * height_in_m)`
    *   **BMI Categorization:**
        *   `Underweight`: < 18.5
        *   `Normal weight`: 18.5 – 24.9
        *   `Overweight`: 25.0 – 29.9
        *   `Obesity Class I`: 30.0 – 34.9
        *   `Obesity Class II`: 35.0 – 39.9
        *   `Obesity Class III`: ≥ 40.0
    *   **Error Handling:** If any validation failed, return appropriate error messages to the user.

*   **User sees:**
    *   A "Calculating..." or "Processing..." loading animation/message.

---

### **Step 6: Prepare LLM Prompt & Call LLM API**

*   **Backend Logic:**
    *   Construct a detailed prompt for the LLM, combining all collected information.

    ```markdown
    **System Role:** You are a helpful, empathetic, and general health assistant. Your purpose is to provide general, actionable health and wellness tips. You are NOT a medical professional, and your advice should always emphasize consultation with a qualified healthcare provider. Do not diagnose or prescribe. Maintain a positive and encouraging tone.

    **User Input & Context:**
    The user is a [Age] year old [Male/Female/User chose not to say].
    Their calculated Body Mass Index (BMI) is: [Calculated BMI Value]
    This places them in the **[BMI Category]** category.
    Original Weight: [Original Weight] [Weight Unit]
    Original Height: [Original Height] [Height Unit]

    **Instructions:**
    1.  Acknowledge the user's BMI and category.
    2.  Provide a clear, concise explanation of what this BMI category generally means in terms of health.
    3.  Based on this BMI category, generate 3-5 *general, actionable, and practical* health tips covering:
        *   **Diet/Nutrition:** Focus on balanced eating, healthy choices (e.g., whole foods, hydration), not restrictive diets.
        *   **Physical Activity/Exercise:** General recommendations (e.g., walking, variety, consistency).
        *   **Lifestyle/Well-being:** (e.g., sleep, stress, consistency, self-care).
    4.  Include a strong reminder at the end that these are general tips, and personalizing them requires consulting a doctor or registered dietitian.
    5.  Avoid specific numbers for calorie intake or workout plans, as these require professional assessment.
    6.  If the BMI is in an extreme category (Underweight or Obese Class III), gently suggest immediate professional consultation.
    ```
    *   **API Call:** Send the constructed prompt to the GPT model API.
    *   **Handle Response:** Parse the LLM's text response.

---

### **Step 7: Display Results & LLM-Generated Tips**

*   **User sees:**
    *   **Title:** "Your BMI Results & Personalized Health Tips"
    *   **Your BMI:**
        *   **`[Calculated BMI Value]`** (Large, prominent number)
        *   **Your Category:** **`[BMI Category]`** (e.g., "Normal Weight")
        *   A brief, standard explanation of what this category means (e.g., "A normal BMI suggests your weight is within a healthy range for your height. This is often associated with lower risks of various health conditions.")
    *   **Explanation of BMI:**
        *   "**What is BMI?** BMI is a simple measure of body fat based on your height and weight. While a useful screening tool, it doesn't directly measure body fat or account for muscle mass, body composition, or distribution. It may not be accurate for everyone (e.g., highly muscular individuals, pregnant women, elderly)."
    *   **Your Personalized Health Tips (Generated by LLM):**
        *   **Heading:** "General Health & Wellness Insights for You"
        *   **LLM Output:** The formatted text directly from the GPT model, tailored to the user's BMI and demographic info. (Example structure below)
            *   *Example (Normal Weight):* "Great news, your BMI of 22.5 places you in the 'Normal Weight' category! This indicates your weight is generally healthy for your height. To maintain and build upon this foundation, here are some general tips:
                1.  **Balanced Eating:** Continue to focus on a varied diet rich in whole foods like fruits, vegetables, lean proteins, and whole grains. Hydrate well throughout the day.
                2.  **Regular Activity:** Aim for at least 150 minutes of moderate-intensity activity per week, like brisk walking, cycling, or swimming. Incorporate strength training a couple of times a week to maintain muscle mass.
                3.  **Mindful Living:** Prioritize 7-9 hours of quality sleep nightly. Manage stress through activities you enjoy, whether it's reading, meditation, or spending time in nature."
            *   *Example (Overweight):* "Your BMI of 27.8 places you in the 'Overweight' category. While BMI is just one indicator, this suggests your weight may be higher than what is generally considered healthy for your height. Small, consistent changes can make a big difference for your long-term health. Here are some general tips to consider:
                1.  **Nutrient-Rich Diet:** Focus on increasing your intake of vegetables, fruits, and lean proteins, which are filling and nutrient-dense. Reduce processed foods, sugary drinks, and excessive portion sizes.
                2.  **Gradual Increase in Activity:** Start with activities you enjoy, like daily brisk walking for 30 minutes, and gradually increase intensity or duration. Consistency is more important than extreme efforts initially.
                3.  **Holistic Well-being:** Ensure adequate sleep, as it plays a crucial role in metabolism and appetite regulation. Explore stress-reduction techniques, as stress can sometimes influence eating habits."
            *   *Example (Obese Class III):* "Your BMI of 41.2 places you in the 'Obesity Class III' category. This indicates a significantly elevated weight for your height, which can be associated with higher health risks. It's highly recommended to seek professional guidance for a comprehensive health plan. Here are some very general initial thoughts, but please prioritize consulting a doctor:
                1.  **Seek Professional Nutritional Guidance:** Working with a registered dietitian can help you develop a sustainable, personalized eating plan that supports weight management and overall health without deprivation.
                2.  **Consult a Doctor for Activity Recommendations:** Before starting any new exercise regimen, especially with a higher BMI, it's crucial to consult your doctor to ensure activities are safe and appropriate for your current health status and mobility.
                3.  **Comprehensive Health Review:** A medical professional can help identify any underlying health conditions related to weight and guide you on a safe and effective path towards improving your health."
    *   **Repeat of Critical Disclaimer (Very Important!):** Reiterate the initial disclaimer at the bottom of the results page.
    *   **Call to Action:** "Restart" / "Ask a Follow-up Question (limited)" (Button)

---

### **Step 8: Optional: Follow-up Questions (Limited)**

*   **User sees:**
    *   If "Ask a Follow-up Question" is clicked, a text input field appears.
    *   **Prompt:** "What else would you like to know about general health related to your BMI? (e.g., 'What are some low-impact exercises?', 'How can I improve my sleep?')"
    *   **Input Field:** [_________]
    *   **Call to Action:** "Ask" (Button)
*   **Backend Logic:**
    *   **Construct New Prompt:** Send the user's follow-up question along with the *original context* (age, sex, BMI, category) to the LLM.
    *   **LLM Role Reinforcement:** Ensure the LLM's system role reminds it to stay general, not diagnose, and refer to professionals.
    *   **Safety Filter:** Implement basic content moderation for follow-up questions to prevent misuse or attempts to solicit medical diagnoses.
*   **User sees:**
    *   The LLM's response to the follow-up question, again with disclaimers.

---

## IV. Technical Considerations

*   **Data Storage:** For a simple, single-use tool, no persistent user data storage is strictly necessary. All data can be held in session memory for the duration of the user's interaction. If user accounts are introduced, then a secure database is needed.
*   **API Security:** Ensure API keys for the LLM are securely managed (e.g., environment variables, secret management services) and never exposed client-side.
*   **Rate Limiting:** Implement rate limiting on the backend for LLM API calls to prevent abuse and manage costs.
*   **Frontend UX:** Use clear labels, progress indicators, and intuitive form elements. Make sure the disclaimer is visually distinct and prominent.
*   **Accessibility:** Design with accessibility in mind (keyboard navigation, screen reader compatibility).
*   **Ethical AI:** Continuously monitor LLM output for unintended biases or potentially harmful advice. Reinforce the system role and disclaimers.

---

This design provides a robust, user-friendly, and responsible system for BMI calculation and AI-powered general health tips. The emphasis on disclaimers and the step-by-step approach ensures users receive valuable information while understanding the limitations of the tool.